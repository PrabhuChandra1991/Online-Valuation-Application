<div class="container-fluid">
  <h3>Import Answersheet List with Dummy Numbers</h3>
  <div class="row col-md-10">
    <div class="col-md-2">
      <select
        id="institutionId"
        class="form-select"
        (change)="onInstituteChange($event)"
      >
        <option [value]="0">Institution</option>
        <option
          *ngFor="let inst of dataSourceInstitutes"
          [value]="inst.institutionId"
        >
          {{ inst.name }}
        </option>
      </select>
    </div>
    <div class="col-md-2">
      <select
        id="examYearId"
        class="form-select"
        (change)="onExamYearChange($event)"
      >
        <option [value]="0">Exam Year</option>
        <option *ngFor="let item of dataSourceExamYears" [value]="item">
          {{ item }}
        </option>
      </select>
    </div>
    <div class="col-md-2">
      <select
        id="examMonthId"
        class="form-select"
        (change)="onExamMonthChange($event)"
      >
        <option [value]="0">Exam Month</option>
        <option *ngFor="let item of dataSourceExamMonths" [value]="item">
          {{ item }}
        </option>
      </select>
    </div>
  </div>
  <br />
  <div class="row col-md-12">
    <div class="col-md-4">
      <select
        id="courseId"
        class="form-select"
        (change)="onExaminationChange($event)"
      >
        <option [value]="0">Examination/Course</option>
        <option
          *ngFor="let item of dataSourceExaminations"
          [value]="item.examinationId"
        >
          {{ item.courseCode }} ----- {{ item.departmentCode }} ----- ({{
            item.studentCount
          }})
        </option>
      </select>
    </div>
    <div class="col-md-6">
      <form
        [formGroup]="dummyNumberImportForm"
        (ngSubmit)="submitDummyNumberImport()"
      >
        <div class="col-md-6">
          <input
            class="form-control"
            value="gedDummyNumberformControls['file']"
            type="file"
            id="masterfile"
            formControlName="file"
            (change)="onDummyNumberFileChange($event)"
          />
          <button
            type="submit"
            class="btn btn-primary"
            [disabled]="!isDummyNumberImported"
          >
            Import
          </button>
        </div>
      </form>
    </div>
  </div>
  <div class="row col-md-12">
    <div class="col-md-4">
      <b>Imported Excel documents</b>
      <br />
      <i>Please click below link to review dummy numbers</i>
      <br />
      <br />
      <ul>
        <li
          *ngFor="let item of dataSourceAnswerSheetImports"
          [value]="item.answersheetImportId"
          [ngStyle]="{
            color:
              item.documentName == selectedAnswersheetName ? 'blue' : 'black'
          }"
          (click)="
            loadAnswersheetImportDetails(
              item.answersheetImportId,
              item.documentName
            )
          "
        >
          <a>{{ item.documentName.split("\\")[2] }}</a>
        </li>
      </ul>
    </div>
    <div class="col-md-8">
      <b>Dummy Numbers blongs:</b>
      {{ selectedAnswersheetName.split("\\")[2] }}
      <b> Count:</b>
      {{ dataSourceAnswerSheetImportDetails.length }}

      <button
        [disabled]="selectedAnswersheetName === ''"
        class="btn btn-primary float-end"
        (click)="promptBeforeReviewCompletion()"
      >
        Complete Review
      </button>

      <div class="row mt-4">
        <div class="col-lg-12 custom-table-style">
          <div class="table-responsive">
            <!-- Table -->
            <table
              mat-table
              [dataSource]="dataSourceAnswerSheetImportDetails"
              matSort
              class="mat-elevation-z8"
            >
              <!-- Name Column -->
              <ng-container matColumnDef="dummyNumber">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                  Dummy Number
                </th>
                <td mat-cell *matCellDef="let element">
                  {{ element.dummyNumber }}
                </td>
              </ng-container>
              <!-- Name Column -->
              <ng-container matColumnDef="isValid">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                  Is valid?
                </th>
                <td mat-cell *matCellDef="let element">
                  {{ element.isValid ? "Valid" : "Invalid" }}
                </td>
              </ng-container>
              <!-- Name Column -->
              <ng-container matColumnDef="errorMessage">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                  Error Message
                </th>
                <td mat-cell *matCellDef="let element">
                  {{ element.errorMessage }}
                </td>
              </ng-container>
              <!-- Table Header & Row Definitions -->
              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
            </table>
          </div>
          <!-- Pagination -->
          <mat-paginator
            class="mt-3 pagination"
            [pageSizeOptions]="[10, 25, 50, 100]"
            showFirstLastButtons
          ></mat-paginator>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Confirmation Modal -->
<ng-template #confirmModule let-modal>
  <div class="modal-body">
    <div class="row col-md-20">
      <h6>Please confirm, dummy numbers are reviewed and completed?</h6>
    </div>
  </div>
  <div class="modal-footer">
    <button
      type="button"
      class="btn btn-danger px-4"
      (click)="modal.close('by: no button')"
    >
      No
    </button>
    <button
      type="button"
      class="btn btn-primary px-4"
      (click)="completeDummyNumberReview()"
    >
      Yes
    </button>
  </div>
</ng-template>
